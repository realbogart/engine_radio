<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="/simplesocket"></script>
		
		<script type="text/javascript">
		var webSocket = $.simpleWebSocket({ url: '<websocket_server>' });
		webSocket.connect();
		
		webSocket.isConnected(function(connected) {
			webSocket.send('connected');
		});
		
		webSocket.listen(function(msgString) {
			var msgJson = JSON.parse( msgString );

			if(msgJson.type == 'setSchedule') {
				scheduleJson = JSON.parse( msgJson.data );
				jQuery('#schedule').html('');
				
				jQuery.each(scheduleJson.schedule, function(i, val) {
					if( val.label.length > 0 )
					{
						jQuery('#schedule').append(val.label + '|' + val.image + '\n');
					}
				});
			}
		});
			
		$(function() {
			$('#update').click(function() {
				var scheduleText = $('#schedule').val();
				var rows = scheduleText.split("\n");
				
				var scheduleJson = new Object();
				scheduleJson.schedule = [];
				
				jQuery.each(rows, function(i, val) {
					var showInfo = val.split("|");
					var show = new Object();
					show.label = showInfo[0];
					show.image = showInfo[1];
					scheduleJson.schedule.push( show );
				});

				$.post('/updateSchedule', JSON.stringify( scheduleJson ), function() {
					
				});
			});
		});
		</script>
	</head>
	<body>
		<textarea id="schedule" rows="8" cols="120"></textarea><br><br>
		<input id="update" type="submit" value="Update"/>
	</body>
</html>
