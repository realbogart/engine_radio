<html>
	<head>
		<link rel="stylesheet" type="text/css" href="/style">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="/simplesocket"></script>
		
		<script type="text/javascript">
			var scheduleJson;
			var webSocket = $.simpleWebSocket({ url: '<websocket_server>' });
			webSocket.connect();
			
			webSocket.isConnected(function(connected) {
				webSocket.send('connected');
			});
			
			webSocket.listen(function(msgString) {
				var msgJson = JSON.parse( msgString );

				if(msgJson.type == 'reload') {
					$('link[href="/style"]').attr('href','/style');
				}
				else if(msgJson.type == 'setBackground') {
					$("body").css("background-image","url('"+msgJson.data+"')");
				}
				else if(msgJson.type == 'setActiveShow') {
					for(i = 0; i < 10; i++)
					{
						$("#show"+i).removeClass("showActive");
						$("#show"+i).addClass("showInactive");
					}
					
					$("#show"+msgJson.data).addClass("showActive");
					
					if( !(typeof scheduleJson.schedule[msgJson.data] === 'undefined') )
					{
						$("body").css("background-image","url('"+scheduleJson.schedule[msgJson.data].image+"')");
					}
				}
				else if(msgJson.type == 'setSchedule') {
					scheduleJson = JSON.parse( msgJson.data );
					jQuery('#schedule').html('');
					
					jQuery.each(scheduleJson.schedule, function(i, val) {
						jQuery('#schedule').append('<p id="show'+i+'" class="showInactive">'+val.label+'</p>');
					});
				}
			});
		</script>
	</head>
	<body>
		<div id="stream">
			<audio controls autoplay>
				<source src="<stream_ip>" id="audio" type="audio/mpeg">
			</audio>
		</div>
		
		<div id="schedule">
		</div>
	</body>
</html>
